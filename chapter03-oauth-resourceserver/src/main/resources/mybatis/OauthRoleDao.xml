<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.wudimanong.oauth.resource.dao.mapper.OauthRoleDao">
    <resultMap id="BaseResultMap" type="com.wudimanong.oauth.entity.model.OauthRole">

        <id column="ROLE_ID" property="roleId" jdbcType="VARCHAR"/>
        <result column="ROLE_CODE" property="roleCode" jdbcType="VARCHAR"/>
        <result column="ROLE_NAME" property="roleName" jdbcType="VARCHAR"/>
        <result column="CREATE_DATE" property="createDate" jdbcType="TIMESTAMP"/>
        <result column="UPDATE_DATE" property="updateDate" jdbcType="TIMESTAMP"/>
    </resultMap>

    <resultMap id="roleMap" type="com.wudimanong.oauth.entity.model.OauthRole">
        <id column="ROLE_ID" property="roleId" jdbcType="VARCHAR"/>
        <result column="ROLE_CODE" property="roleCode" jdbcType="VARCHAR"/>
        <result column="ROLE_NAME" property="roleName" jdbcType="VARCHAR"/>
        <result column="CREATE_DATE" property="createDate" jdbcType="TIMESTAMP"/>
        <result column="UPDATE_DATE" property="updateDate" jdbcType="TIMESTAMP"/>
        <collection column="{roleId=ROLE_ID,userId=USER_ID}" property="modules"
                select="com.wudimanong.oauth.resource.dao.mapper.OauthModuleResourcesDao.selectModuleByRoleId"/>
    </resultMap>

    <select id="getRoleByUserId" resultMap="roleMap">
      SELECT br.*, bur.USER_ID as USER_ID FROM
      oauth_user_role bur LEFT JOIN oauth_role br ON bur.ROLE_ID = br.ROLE_ID
      WHERE bur.USER_ID = #{userId}
    </select>
</mapper>